import{_ as e,c as d,o as a,a4 as o}from"./chunks/framework.QjAkUUnS.js";const b=JSON.parse('{"title":"控制方式说明","description":"","frontmatter":{},"headers":[],"relativePath":"docs/2.4-ControlMethods.md","filePath":"docs/2.4-控制方式说明.md","lastUpdated":null}'),r={name:"docs/2.4-ControlMethods.md"};function c(n,t,i,p,h,l){return a(),d("div",null,[...t[0]||(t[0]=[o('<h1 id="控制方式说明" tabindex="-1">控制方式说明 <a class="header-anchor" href="#控制方式说明" aria-label="Permalink to &quot;控制方式说明&quot;">​</a></h1><p>本文档详细说明 MaaFramework 中 Input（控制）和 Screencap（截图）的各种方式及其配置。</p><blockquote><p><strong>注意：</strong></p><ul><li>对于 API ，input/screencap 使用 <code>int</code> 类型（按位或组合）；对于 <a href="3.3-ProjectInterfaceV2">ProjectInterface V2</a>，使用 <code>string</code> 类型（直接使用名称）。</li><li><a href="3.3-ProjectInterfaceV2">ProjectInterface V2</a> 仅支持配置 Win32 控制器的 input/screencap 方式。Adb 控制器的 input/screencap 由 MaaFramework 自动检测和选择最优方式，无需手动配置。</li></ul></blockquote><h2 id="adb" tabindex="-1">Adb <a class="header-anchor" href="#adb" aria-label="Permalink to &quot;Adb&quot;">​</a></h2><h3 id="adb-input" tabindex="-1">Adb Input <a class="header-anchor" href="#adb-input" aria-label="Permalink to &quot;Adb Input&quot;">​</a></h3><blockquote><p>参考 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/include/MaaFramework/MaaDef.h#L227-L240" target="_blank" rel="noopener noreferrer">MaaDef.h</a></p></blockquote><p>将下面选择的方式 <strong>按位或</strong> 合并为一个值提供。MaaFramework 将会按照固定优先级顺序尝试所有提供的方式，选择首个可用方式。</p><p>默认尝试除 EmulatorExtras 外所有方式。</p><blockquote><p>优先级: EmulatorExtras &gt; Maatouch &gt; MinitouchAndAdbKey &gt; AdbShell</p></blockquote><table tabindex="0"><thead><tr><th>名称</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>AdbShell</td><td><code>1</code></td><td>使用 adb 进程进行控制。</td></tr><tr><td>MinitouchAndAdbKey</td><td><code>2</code></td><td>使用 adb 进程进行按键控制，使用 minitouch 工具进行触摸控制。</td></tr><tr><td>Maatouch</td><td><code>4</code></td><td>使用 maatouch 工具控制。</td></tr><tr><td>EmulatorExtras</td><td><code>8</code></td><td>使用模拟器专用工具进行控制。目前支持的模拟器：MuMu 12</td></tr></tbody></table><h3 id="adb-screencap" tabindex="-1">Adb Screencap <a class="header-anchor" href="#adb-screencap" aria-label="Permalink to &quot;Adb Screencap&quot;">​</a></h3><blockquote><p>参考 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/include/MaaFramework/MaaDef.h#L208-L225" target="_blank" rel="noopener noreferrer">MaaDef.h</a></p></blockquote><p>将下面选择的方式 <strong>按位或</strong> 合并为一个值提供。MaaFramework 将会尝试所有提供的方式，选择最快的可用方式。</p><p>默认尝试除 <code>RawByNetcat</code>，<code>MinicapDirect</code>，<code>MinicapStream</code> 外所有方式。</p><p><code>MinicapDirect</code> 和 <code>MinicapStream</code> 由于会编码为 jpg，为有损编码，将显著降低模板匹配的效果，不建议使用。</p><table tabindex="0"><thead><tr><th>名称</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>EncodeToFileAndPull</td><td><code>1</code></td><td>通过内置 screencap 进程截图，编码为 png 输出到文件，通过 adb 进程拉取文件，读取文件。</td></tr><tr><td>Encode</td><td><code>2</code></td><td>通过内置 screencap 进程截图，编码为 png，通过 adb 进程管道传输。</td></tr><tr><td>RawWithGzip</td><td><code>4</code></td><td>通过内置 screencap 进程截图，通过 gzip 压缩，通过 adb 进程管道传输。</td></tr><tr><td>RawByNetcat</td><td><code>8</code></td><td>通过内置 screencap 进程截图，通过 nc 进程网络传输。</td></tr><tr><td>MinicapDirect</td><td><code>16</code></td><td>通过 minicap 工具截图和编码为 jpg，通过 adb 进程管道传输。</td></tr><tr><td>MinicapStream</td><td><code>32</code></td><td>通过 minicap 工具流式截图和编码为 jpg，通过 adb 进程管道传输。</td></tr><tr><td>EmulatorExtras</td><td><code>64</code></td><td>使用模拟器专用工具进行截图。目前支持的模拟器：MuMu 12、雷电 9</td></tr></tbody></table><h2 id="win32" tabindex="-1">Win32 <a class="header-anchor" href="#win32" aria-label="Permalink to &quot;Win32&quot;">​</a></h2><h3 id="win32-input" tabindex="-1">Win32 Input <a class="header-anchor" href="#win32-input" aria-label="Permalink to &quot;Win32 Input&quot;">​</a></h3><blockquote><p>参考 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/include/MaaFramework/MaaDef.h#L252-L259" target="_blank" rel="noopener noreferrer">MaaDef.h</a></p></blockquote><p>选择下面的值提供。</p><p>无默认值。Client 可以选择一个作为默认值。</p><p>Win32 下不同程序处理输入的方法不同，不存在一个通用方式。</p><table tabindex="0"><thead><tr><th>名称</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>Seize</td><td><code>1</code></td><td>抢占式控制。通过 <code>SendInput</code>/前台聚焦进行输入；会抢占焦点、移动系统光标、阻塞用户输入，不能后台控制。</td></tr><tr><td>SendMessage</td><td><code>2</code></td><td>直接向窗口发送 <code>WM_*</code> 消息；可后台控制（窗口可失焦），但受 UIPI/权限限制：若目标为高完整性进程（管理员运行），需要以相同或更高权限运行。</td></tr><tr><td>PostMessage</td><td><code>4</code></td><td>与 <code>SendMessage</code> 类似但异步投递；可后台控制，同样受 UIPI/权限限制。</td></tr><tr><td>LegacyEvent</td><td><code>8</code></td><td>旧版 <code>mouse_event</code>/<code>keybd_event</code> 接口；依赖前台与系统光标、阻塞用户输入，实测兼容性一般，不能后台控制。</td></tr><tr><td>PostThreadMessage</td><td><code>16</code></td><td>向窗口所属线程消息队列投递消息；可后台控制，但要求目标线程有消息循环，同样受 UIPI/权限限制。</td></tr><tr><td>SendMessageWithCursorPos</td><td><code>32</code></td><td>结合 <code>SendMessage</code> 与实际光标移动；通过 <code>SetCursorPos</code> 移动系统光标到目标位置后发送同步消息。专为原神等检测实际鼠标位置的游戏设计，可后台控制，同样受 UIPI/权限限制。</td></tr><tr><td>PostMessageWithCursorPos</td><td><code>64</code></td><td>结合 <code>PostMessage</code> 与实际光标移动；通过 <code>SetCursorPos</code> 移动系统光标到目标位置后发送异步消息。专为原神等检测实际鼠标位置的游戏设计，可后台控制，同样受 UIPI/权限限制。</td></tr></tbody></table><h3 id="win32-screencap" tabindex="-1">Win32 Screencap <a class="header-anchor" href="#win32-screencap" aria-label="Permalink to &quot;Win32 Screencap&quot;">​</a></h3><blockquote><p>参考 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/include/MaaFramework/MaaDef.h#L242-L250" target="_blank" rel="noopener noreferrer">MaaDef.h</a></p></blockquote><p>选择下面的值提供。</p><p>无默认值。Client 可以选择一个作为默认值。</p><p>Win32 下不同程序处理绘制的方法不同，不存在一个通用方式。</p><table tabindex="0"><thead><tr><th>名称</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>GDI</td><td><code>1</code></td><td>基于窗口 <code>HDC</code>/<code>BitBlt</code> 的抓取；对部分程序/遮挡情形可能受 DWM/渲染路径影响。</td></tr><tr><td>FramePool</td><td><code>2</code></td><td>Windows Graphics Capture（<code>Direct3D11CaptureFramePool</code>）；对被遮挡窗口通常可后台抓取，Windows 10 1903+ 可用。</td></tr><tr><td>DXGI_DesktopDup</td><td><code>4</code></td><td>桌面复制（全屏输出复制）；不支持后台抓取窗口（会包含遮挡内容/仅桌面帧）。</td></tr><tr><td>DXGI_DesktopDup_Window</td><td><code>8</code></td><td>桌面复制后裁剪到窗口客户区；与 <code>DXGI_DesktopDup</code> 一致，遮挡会影响结果。</td></tr><tr><td>PrintWindow</td><td><code>16</code></td><td>使用 `PrintWindow(PW_CLIENTONLY</td></tr><tr><td>ScreenDC</td><td><code>32</code></td><td>从屏幕 DC 依据窗口客户区矩形裁剪抓取；完全受遮挡影响，不支持后台。</td></tr></tbody></table>',29)])])}const u=e(r,[["render",c]]);export{b as __pageData,u as default};
