import{_ as h,C as r,c,o as e,a4 as n,b as l,j as d,w as s,a,G as o,a5 as p}from"./chunks/framework.QjAkUUnS.js";const F=JSON.parse('{"title":"任务流水线（Pipeline）协议","description":"","frontmatter":{},"headers":[],"relativePath":"docs/3.1-PipelineProtocol.md","filePath":"docs/3.1-任务流水线协议.md","lastUpdated":null}'),k={name:"docs/3.1-PipelineProtocol.md"};function E(g,i,u,m,y,b){const t=r("Mermaid");return e(),c("div",null,[i[4]||(i[4]=n(`<h1 id="任务流水线-pipeline-协议" tabindex="-1">任务流水线（Pipeline）协议 <a class="header-anchor" href="#任务流水线-pipeline-协议" aria-label="Permalink to &quot;任务流水线（Pipeline）协议&quot;">​</a></h1><h2 id="基础格式" tabindex="-1">基础格式 <a class="header-anchor" href="#基础格式" aria-label="Permalink to &quot;基础格式&quot;">​</a></h2><p>任务流水线采用 JSON 格式描述，由若干节点（Node）构成，每个节点包含以下核心属性：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;recognition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OCR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 识别算法</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 执行动作</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                 // 后继节点列表</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">NodeB</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">NodeC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        // 其他扩展属性...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    // 其他节点定义...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span></span></code></pre></div><h2 id="执行逻辑" tabindex="-1">执行逻辑 <a class="header-anchor" href="#执行逻辑" aria-label="Permalink to &quot;执行逻辑&quot;">​</a></h2><h3 id="流程控制机制" tabindex="-1">流程控制机制 <a class="header-anchor" href="#流程控制机制" aria-label="Permalink to &quot;流程控制机制&quot;">​</a></h3><ol><li><p><strong>任务触发</strong></p><ul><li>通过 tasker.post_task 接口指定入口节点启动任务</li></ul></li><li><p><strong>顺序检测</strong></p><ul><li>对当前节点的 next 列表进行顺序检测</li><li>依次尝试识别每个子节点配置的 recognition 特征</li></ul></li><li><p><strong>中断机制</strong></p><ul><li>当检测到某个子节点匹配成功时，立即终止后续节点检测</li><li>执行匹配节点的 action 定义的操作</li></ul></li><li><p><strong>后继处理</strong></p><ul><li>操作执行完成后，将激活节点切换为当前节点</li><li>重复执行上述检测流程</li></ul></li></ol><h3 id="终止条件" tabindex="-1">终止条件 <a class="header-anchor" href="#终止条件" aria-label="Permalink to &quot;终止条件&quot;">​</a></h3><p>当满足以下任意条件时，任务流程终止：</p><ul><li>当前节点的 next 列表为空</li><li>所有后继节点持续检测失败直至超时</li></ul><h2 id="应用示例" tabindex="-1">应用示例 <a class="header-anchor" href="#应用示例" aria-label="Permalink to &quot;应用示例&quot;">​</a></h2><h3 id="场景描述" tabindex="-1">场景描述 <a class="header-anchor" href="#场景描述" aria-label="Permalink to &quot;场景描述&quot;">​</a></h3><p>Android 设置界面存在菜单 <code>显示</code>/<code>存储</code>/<code>无障碍</code>，其中 <code>存储</code> 打开后包含二级菜单 <code>游戏</code>/<code>应用</code>。</p><h3 id="配置示例" tabindex="-1">配置示例 <a class="header-anchor" href="#配置示例" aria-label="Permalink to &quot;配置示例&quot;">​</a></h3><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;开始示例&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;进入显示&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;进入存储&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;进入无障碍&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;进入显示&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;recognition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XXX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;进入存储&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;recognition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XXX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;进入游戏二级菜单&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;进入应用二级菜单&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;进入无障碍&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;进入游戏二级菜单&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Swipe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;进入应用二级菜单&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="执行过程推演" tabindex="-1">执行过程推演 <a class="header-anchor" href="#执行过程推演" aria-label="Permalink to &quot;执行过程推演&quot;">​</a></h3><h4 id="情况一" tabindex="-1">情况一 <a class="header-anchor" href="#情况一" aria-label="Permalink to &quot;情况一&quot;">​</a></h4>`,17)),(e(),l(p,null,{default:s(()=>[o(t,{id:"mermaid-118",class:"mermaid",graph:"%20%20%20%20graph%20LR%0A%20%20%20%20%20%20%20%20A%5B**%E5%BC%80%E5%A7%8B%E7%A4%BA%E4%BE%8B**%5D%20--%3E%7C1.%E8%AF%86%E5%88%AB%7C%20B%5B**%E8%BF%9B%E5%85%A5%E6%98%BE%E7%A4%BA**%5D%0A%20%20%20%20%20%20%20%20B%20--%3E%7C2.%E8%AF%86%E5%88%AB%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%BF%94%E5%9B%9E%E8%AF%86%E5%88%AB%E4%B8%8B%E4%B8%80%E8%8A%82%E7%82%B9%7C%20A%0A%20%20%20%20%20%20%20%20A%20--%3E%7C3.%E8%AF%86%E5%88%AB%7C%20C%5B**%E8%BF%9B%E5%85%A5%E5%AD%98%E5%82%A8**%5D%0A%20%20%20%20%20%20%20%20A%20--%3E%7C%E6%9C%AA%E8%BF%9B%E8%A1%8C%7C%20ZA%5B**%E8%BF%9B%E5%85%A5%E6%97%A0%E9%9A%9C%E7%A2%8D**%5D%0A%20%20%20%20%20%20%20%20C%20--%3E%7C4.%E8%AF%86%E5%88%AB%E6%88%90%E5%8A%9F%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%7C%20D%5B%E7%82%B9%E5%87%BB%5D%0A%20%20%20%20%20%20%20%20D%20--%3E%7C5.%E8%8A%82%E7%82%B9%E5%AE%8C%E6%88%90%7C%20E%5B%E8%AF%86%E5%88%AB%20**%E8%BF%9B%E5%85%A5%E5%AD%98%E5%82%A8**%20%E7%9A%84%20next%5D%0A%20%20%20%20%20%20%20%20E%20--%3E%7C6.%E8%AF%86%E5%88%AB%7C%20F%5B**%E8%BF%9B%E5%85%A5%E6%B8%B8%E6%88%8F%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%95**%5D%0A%20%20%20%20%20%20%20%20E%20--%3E%7C%E6%9C%AA%E8%BF%9B%E8%A1%8C%7C%20G%5B**%E8%BF%9B%E5%85%A5%E5%BA%94%E7%94%A8%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%95**%5D%0A%20%20%20%20%20%20%20%20F%20--%3E%7C7.%E8%AF%86%E5%88%AB%E6%88%90%E5%8A%9F%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%7C%20I%5B%E6%BB%91%E5%8A%A8%5D%0A%20%20%20%20%20%20%20%20I%20--%3E%7C8.%E8%8A%82%E7%82%B9%E5%AE%8C%E6%88%90%7C%20J%5B%E8%AF%86%E5%88%AB%20**%E8%BF%9B%E5%85%A5%E6%B8%B8%E6%88%8F%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%95**%20%E7%9A%84%20next%5D%0A%20%20%20%20%20%20%20%20J%20--%3E%7C9.next%20%E4%B8%BA%E7%A9%BA%7C%20H%5B%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90%5D%0A"})]),fallback:s(()=>[...i[0]||(i[0]=[a(" Loading... ",-1)])]),_:1})),i[5]||(i[5]=d("h4",{id:"情况二",tabindex:"-1"},[a("情况二 "),d("a",{class:"header-anchor",href:"#情况二","aria-label":'Permalink to "情况二"'},"​")],-1)),(e(),l(p,null,{default:s(()=>[o(t,{id:"mermaid-122",class:"mermaid",graph:"%20%20%20%20graph%20LR%0A%20%20%20%20%20%20%20%20A%5B**%E5%BC%80%E5%A7%8B%E7%A4%BA%E4%BE%8B**%5D%20--%3E%7C1.%E8%AF%86%E5%88%AB%7C%20B%5B**%E8%BF%9B%E5%85%A5%E6%98%BE%E7%A4%BA**%5D%0A%20%20%20%20%20%20%20%20B%20--%3E%7C2.%E8%AF%86%E5%88%AB%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%BF%94%E5%9B%9E%E8%AF%86%E5%88%AB%E4%B8%8B%E4%B8%80%E8%8A%82%E7%82%B9%7C%20A%0A%20%20%20%20%20%20%20%20A%20--%3E%7C3.%E8%AF%86%E5%88%AB%7C%20Y%5B**%E8%BF%9B%E5%85%A5%E5%AD%98%E5%82%A8**%5D%0A%20%20%20%20%20%20%20%20Y%20--%3E%7C4.%E8%AF%86%E5%88%AB%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%BF%94%E5%9B%9E%E8%AF%86%E5%88%AB%E4%B8%8B%E4%B8%80%E8%8A%82%E7%82%B9%7C%20A%0A%20%20%20%20%20%20%20%20A%20--%3E%7C5.%E8%AF%86%E5%88%AB%7C%20Z%5B**%E8%BF%9B%E5%85%A5%E6%97%A0%E9%9A%9C%E7%A2%8D**%5D%0A%20%20%20%20%20%20%20%20Z%20--%3E%7C6.%E8%AF%86%E5%88%AB%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%BF%94%E5%9B%9E%E8%AF%86%E5%88%AB%E4%B8%8B%E4%B8%80%E8%8A%82%E7%82%B9%7C%20A%0A%20%20%20%20%20%20%20%20A%20--%3E%7C7.next%20%E5%85%A8%E9%83%A8%E6%9C%AA%E5%91%BD%E4%B8%AD%7CE%7B%E6%98%AF%E5%90%A6%E8%B6%85%E6%97%B6%EF%BC%9F%7D%0A%20%20%20%20%20%20%20%20E%20--%3E%7C8.1.%E8%B6%85%E6%97%B6%7C%20ZA%5B%E4%BB%BB%E5%8A%A1%E8%B6%85%E6%97%B6%5D%0A%20%20%20%20%20%20%20%20E%20--%3E%7C8.2.%E6%9C%AA%E8%B6%85%E6%97%B6%7C%20A%0A%20%20%20%20%20%20%20%20A%20--%3E%7C9.%E5%86%8D%E6%AC%A1%E8%AF%86%E5%88%AB%7C%20B%0A%20%20%20%20%20%20%20%20B%20--%3E%7C10.%E8%AF%86%E5%88%AB%E6%88%90%E5%8A%9F%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%7C%20F%5B%E7%82%B9%E5%87%BB%5D%0A"})]),fallback:s(()=>[...i[1]||(i[1]=[a(" Loading... ",-1)])]),_:1})),i[6]||(i[6]=n('<h2 id="属性字段" tabindex="-1">属性字段 <a class="header-anchor" href="#属性字段" aria-label="Permalink to &quot;属性字段&quot;">​</a></h2><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p><strong>对于必选字段，Pipeline JSON 文件中仍可为空，但需在实际执行前通过接口设置。</strong><br> 以点（<code>.</code>）开头的文件夹、JSON 文件将不会被读取。<br> 以 <code>$</code> 开头的 JSON root field 将不会被解析。</p></div><h3 id="pipeline-v1" tabindex="-1">Pipeline v1 <a class="header-anchor" href="#pipeline-v1" aria-label="Permalink to &quot;Pipeline v1&quot;">​</a></h3><ul><li><p><code>recognition</code> : <em>string</em><br> 识别算法类型。可选，默认 <a href="#directhit"><code>DirectHit</code></a> 。<br> 可选的值：<a href="#directhit"><code>DirectHit</code></a> | <a href="#templatematch"><code>TemplateMatch</code></a> | <a href="#featurematch"><code>FeatureMatch</code></a> | <a href="#colormatch"><code>ColorMatch</code></a> | <a href="#ocr"><code>OCR</code></a> | <a href="#neuralnetworkclassify"><code>NeuralNetworkClassify</code></a> | <a href="#neuralnetworkdetect"><code>NeuralNetworkDetect</code></a> | <a href="#custom"><code>Custom</code></a><br> 详见 <a href="#%E7%AE%97%E6%B3%95%E7%B1%BB%E5%9E%8B">算法类型</a>。</p></li><li><p><code>action</code>: <em>string</em><br> 执行的动作。可选，默认 <a href="#donothing"><code>DoNothing</code></a> 。<br> 可选的值：<a href="#donothing"><code>DoNothing</code></a> | <a href="#click"><code>Click</code></a> | <a href="#longpress"><code>LongPress</code></a> | <a href="#swipe"><code>Swipe</code></a> | <a href="#multiswipe"><code>MultiSwipe</code></a> | <a href="#scroll"><code>Scroll</code></a> | <a href="#clickkey"><code>ClickKey</code></a> | <a href="#longpresskey"><code>LongPressKey</code></a> | <a href="#inputtext"><code>InputText</code></a> | <a href="#startapp"><code>StartApp</code></a> | <a href="#stopapp"><code>StopApp</code></a> | <a href="#stoptask"><code>StopTask</code></a> | <a href="#command"><code>Command</code></a> | <a href="#custom-1"><code>Custom</code></a><br> 详见 <a href="#%E5%8A%A8%E4%BD%9C%E7%B1%BB%E5%9E%8B">动作类型</a>。</p></li><li><p><code>next</code> : <em>string</em> | <em>NodeAttr</em> | <em>list&lt;string | NodeAttr, &gt;</em><br> 接下来要执行的节点列表。可选，默认空。<br> 按顺序识别 next 中的每个节点，只执行第一个识别到的。<br> 💡 v5.1 版本起新增支持带属性节点、 NodeAttr 形式对象，或两者结合的异质数组。详情请参考 <a href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7">节点属性</a>。</p></li><li><p><code>is_sub</code>: <em>bool</em><br><strong>（已在 5.1 版本中废弃，推荐使用 <a href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7">节点属性</a> 中的 <code>[JumpBack]</code> 功能替代）</strong><br> 我们提供了 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/tools/migrate_pipeline_v5.py" target="_blank" rel="noopener noreferrer">迁移脚本</a>，可帮助您无损地将 Pipeline 自动转换为新风格~</p></li><li><p><code>interrupt</code> : <em>string</em> | <em>list&lt;string, &gt;</em><br><strong>（已在 5.1 版本中废弃，推荐使用 <a href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7">节点属性</a> 中的 <code>[JumpBack]</code> 功能替代）</strong><br> 我们提供了 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/tools/migrate_pipeline_v5.py" target="_blank" rel="noopener noreferrer">迁移脚本</a>，可帮助您无损地将 Pipeline 自动转换为新风格~</p></li><li><p><code>rate_limit</code>: <em>uint</em><br> 识别速率限制，单位毫秒。可选，默认 1000 。<br> 每轮识别最低消耗 <code>rate_limit</code> 毫秒，不足的时间将会 sleep 等待。</p></li><li><p><code>timeout</code>: <em>uint</em><br> 识别超时时间，毫秒。可选，默认 20 * 1000 。<br> 具体逻辑为 <code>while(!timeout) { foreach(next); sleep_until(rate_limit); }</code> 。</p></li><li><p><code>on_error</code> : <em>string</em> | <em>NodeAttr</em> | <em>list&lt;string | NodeAttr, &gt;</em><br> 当识别超时，或动作执行失败后，接下来会执行该列表中的节点。可选，默认空。<br> 💡 v5.1 版本起新增支持带属性节点、 NodeAttr 形式对象，或两者结合的异质数组。详情请参考 <a href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7">节点属性</a>。</p></li><li><p><code>anchor</code>: <em>string</em> | <em>list&lt;string, &gt;</em><br> 锚点名称。可选，默认空。<br> 当节点执行成功后，会将该锚点名设置为当前节点。多个节点可设置同一个锚点名，后执行的会覆盖先执行的。<br> 在 <code>next</code> 或 <code>on_error</code> 中可通过 <code>[Anchor]</code> 属性引用该锚点，运行时会解析为最后设置该锚点的节点。<br> 详见 <a href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7">节点属性</a>。</p></li><li><p><code>inverse</code>: <em>bool</em><br> 反转识别结果，识别到了当做没识别到，没识别到的当做识别到了。可选，默认 false 。<br> 请注意由此识别出的节点，Click 等动作的点击自身将失效（因为实际并没有识别到东西），若有需求可单独设置 <code>target</code> 。</p></li><li><p><code>enabled</code>: <em>bool</em><br> 是否启用该 node。可选，默认 true 。<br> 若为 false，其他 node 的 next 列表中的该 node 会被跳过，既不会被识别也不会被执行。</p></li><li><p><code>max_hit</code>: <em>uint</em><br> 该节点最多可被识别成功多少次。可选，默认 UINT_MAX ，即无限制。<br> 若超过该次数，其他 node 的 next 列表中的该 node 会被跳过，既不会被识别也不会被执行。</p></li><li><p><code>pre_delay</code>: <em>uint</em><br> 识别到 到 执行动作前 的延迟，毫秒。可选，默认 200 。<br> 推荐尽可能增加中间过程节点，少用延迟，不然既慢还不稳定。</p></li><li><p><code>post_delay</code>: <em>uint</em><br> 执行动作后 到 识别 next 的延迟，毫秒。可选，默认 200 。<br> 推荐尽可能增加中间过程节点，少用延迟，不然既慢还不稳定。</p></li><li><p><code>pre_wait_freezes</code>: <em>uint</em> | <em>object</em><br> 识别到 到 执行动作前，等待画面不动了的时间，毫秒。可选，默认 0 ，即不等待。<br> 连续 <code>pre_wait_freezes</code> 毫秒 画面 <strong>没有较大变化</strong> 才会退出动作。<br> 若为 object，可设置更多参数，详见 <a href="#%E7%AD%89%E5%BE%85%E7%94%BB%E9%9D%A2%E9%9D%99%E6%AD%A2">等待画面静止</a>。<br> 具体的顺序为 <code>pre_wait_freezes</code> - <code>pre_delay</code> - <code>action</code> - <code>post_wait_freezes</code> - <code>post_delay</code> 。</p></li><li><p><code>post_wait_freezes</code>: <em>uint</em> | <em>object</em><br> 行动动作后 到 识别 next，等待画面不动了的时间，毫秒。可选，默认 0 ，即不等待。<br> 其余逻辑同 <code>pre_wait_freezes</code>。</p></li><li><p><code>focus</code>: <em>any</em><br> 关注节点，会额外产生部分回调消息。可选，默认 null，不产生回调消息。<br> 详见 <a href="#%E8%8A%82%E7%82%B9%E9%80%9A%E7%9F%A5">节点通知</a>。</p></li><li><p><code>attach</code>: <em>object</em><br> 附加 JSON 对象，用于保存节点的附加配置。可选，默认空对象。<br> 该字段可用于存储自定义的配置信息，这些信息不会影响节点的执行逻辑，但可以通过相关接口获取。<br><strong>注意</strong>：该字段会与默认值中的 <code>attach</code> 进行字典合并（dict merge），而不是覆盖。即节点中的 <code>attach</code> 会与默认值中的 <code>attach</code> 合并，相同键的值会被节点中的值覆盖，但其他键会保留。</p></li></ul><p>一个节点的生命周期如下</p>',5)),(e(),l(p,null,{default:s(()=>[o(t,{id:"mermaid-229",class:"mermaid",graph:"%20%20%20%20graph%20LR%0A%20%20%20%20%20%20%20%20A%5B%E8%BF%9B%E5%85%A5%E8%8A%82%E7%82%B9%5D%20--%3E%20B%5Bpre_wait_freezes%5D%0A%20%20%20%20%20%20%20%20B%20--%3E%20C%5Bpre_delay%5D%0A%20%20%20%20%20%20%20%20C%20--%3E%20D%5Baction%5D%0A%20%20%20%20%20%20%20%20D%20--%3E%20E%5Bpost_wait_freezes%5D%0A%20%20%20%20%20%20%20%20E%20--%3E%20F%5Bpost_delay%5D%0A%20%20%20%20%20%20%20%20F%20--%3E%20G%5B%E8%AF%86%E5%88%ABnext%5D%0A%20%20%20%20%20%20%20%20G%20--%3E%20H%7B%E6%98%AF%E5%90%A6%E6%9C%89%E8%AF%86%E5%88%AB%E6%88%90%E5%8A%9F%E7%9A%84%E8%8A%82%E7%82%B9%7D%0A%20%20%20%20%20%20%20%20H%20--%3E%7C%E6%98%AF%7C%20I%5B%E8%BF%9B%E5%85%A5%E6%96%B0%E8%8A%82%E7%82%B9%5D%0A%20%20%20%20%20%20%20%20H%20--%3E%7C%E5%90%A6%7C%20J%7Btimeout%7D%0A%20%20%20%20%20%20%20%20J%20--%3E%7C%E8%B6%85%E6%97%B6%7C%20K%5Bon_error%5D%0A%20%20%20%20%20%20%20%20J%20--%3E%7C%E6%9C%AA%E8%B6%85%E6%97%B6%7C%20L%5Brate_limit%5D%0A%20%20%20%20%20%20%20%20L%20--%3E%20G%0A"})]),fallback:s(()=>[...i[2]||(i[2]=[a(" Loading... ",-1)])]),_:1})),i[7]||(i[7]=n(`<h3 id="pipeline-v2" tabindex="-1">Pipeline v2 <a class="header-anchor" href="#pipeline-v2" aria-label="Permalink to &quot;Pipeline v2&quot;">​</a></h3><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>MaaFW 自 v4.4.0 版本起支持 Pipeline v2 协议，同时兼容 v1。</p></div><p>相较 v1，主要将 <code>recognition</code> 和 <code>action</code> 相关字段放入了二级字典中（类型放入 <code>type</code> 字段，其余参数放入 <code>param</code> 字段中），其余并无不同。举例：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;recognition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TemplateMatch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;param&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 识别相关字段放入 recognition.param 中，键和值均无变化</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;template&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;roi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;param&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 动作相关字段放入 action.param 中，键和值均无变化</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;target&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XXX&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 非 recognition 和 action 的字段与 v1 无变化</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NodeB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;pre_delay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="默认属性" tabindex="-1">默认属性 <a class="header-anchor" href="#默认属性" aria-label="Permalink to &quot;默认属性&quot;">​</a></h3><p>请参考 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/sample/resource/default_pipeline.json" target="_blank" rel="noopener noreferrer"><code>default_pipeline.json</code></a><br><code>Default</code> 中可设置所有字段的默认值；算法/动作名 的对象中可设置对应算法/动作 的默认参数值。</p><h2 id="节点属性" tabindex="-1">节点属性 <a class="header-anchor" href="#节点属性" aria-label="Permalink to &quot;节点属性&quot;">​</a></h2><p>节点属性（Node Attributes）允许在 <code>next</code> 和 <code>on_error</code> 列表中为每个节点指定额外的行为控制参数。自 v5.1 版本起，支持通过两种语法形式设置节点属性。</p><h3 id="基本语法" tabindex="-1">基本语法 <a class="header-anchor" href="#基本语法" aria-label="Permalink to &quot;基本语法&quot;">​</a></h3><p>默认情况下，节点列表仅包含节点名称：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;D&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="属性设置方式" tabindex="-1">属性设置方式 <a class="header-anchor" href="#属性设置方式" aria-label="Permalink to &quot;属性设置方式&quot;">​</a></h3><h4 id="对象形式-object-form" tabindex="-1">对象形式（Object Form） <a class="header-anchor" href="#对象形式-object-form" aria-label="Permalink to &quot;对象形式（Object Form）&quot;">​</a></h4><p>使用 <code>NodeAttr</code> 对象显式指定节点名称和属性：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;jump_back&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;D&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="前缀形式-prefix-form" tabindex="-1">前缀形式（Prefix Form） <a class="header-anchor" href="#前缀形式-prefix-form" aria-label="Permalink to &quot;前缀形式（Prefix Form）&quot;">​</a></h4><p>使用方括号前缀在节点名称前直接指定属性：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;[JumpBack]C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;D&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>两种形式功能等价，可根据实际需求选择。在数组中可混合使用两种形式，构成异质数组。</p><h3 id="可用属性" tabindex="-1">可用属性 <a class="header-anchor" href="#可用属性" aria-label="Permalink to &quot;可用属性&quot;">​</a></h3><h4 id="jump-back-jumpback" tabindex="-1"><code>jump_back</code> / <code>[JumpBack]</code> <a class="header-anchor" href="#jump-back-jumpback" aria-label="Permalink to &quot;\`jump_back\` / \`[JumpBack]\`&quot;">​</a></h4><p><strong>类型</strong>: <em>boolean</em><br><strong>默认值</strong>: <code>false</code><br><strong>说明</strong>: 启用跳回机制。当该节点识别命中，系统会在其后续节点链全部执行完毕后，重新返回到该节点所在的父节点，继续尝试识别该父节点的 <code>next</code> 列表。</p><p><strong>执行流程</strong>：</p><ol><li>父节点按顺序识别 <code>next</code> 列表中的节点</li><li>若识别命中带有 <code>jump_back</code> 属性的节点，执行该节点及其后续节点链</li><li>该节点链执行完毕后，返回到父节点</li><li>父节点继续从 <code>next</code> 列表的起始位置重新开始识别</li></ol><p><strong>示例</strong>：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;[JumpBack]D&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;E&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>执行流程：</p><ul><li>节点 A 依次尝试识别 B、C、D、E</li><li>若识别命中 D（假设 B、C 未识别到），执行 D 及其后续节点链</li><li>D 的节点链执行完毕后，返回到节点 A</li><li>节点 A 重新从 B 开始识别，继续尝试 B、C、D、E</li></ul><p><strong>应用场景</strong>：<br> 适用于异常处理场景，例如识别并处理网络断开提示框、权限请求弹窗等临时性界面，处理完成后继续执行原有流程。</p><p><strong>兼容性说明</strong>：<br> 功能类似已废弃的 <code>is_sub</code> 字段，但 <code>jump_back</code> 仅作用于当前 <code>next</code> 列表中的特定节点，而非整个节点定义。</p>`,30)),(e(),l(p,null,{default:s(()=>[o(t,{id:"mermaid-350",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20A%5B%E8%8A%82%E7%82%B9%20A%5D%20--%3E%7C%E8%AF%86%E5%88%AB%7C%20B%5B%E8%8A%82%E7%82%B9%20B%5D%0A%20%20%20%20A%20--%3E%7C%E8%AF%86%E5%88%AB%7C%20C%5B%E8%8A%82%E7%82%B9%20C%5D%0A%20%20%20%20A%20--%3E%7C%E8%AF%86%E5%88%AB%E5%B9%B6%E5%91%BD%E4%B8%AD%7C%20D%5B%E8%8A%82%E7%82%B9%20D%3Cbr%2F%3Ejump_back%3A%20true%5D%0A%20%20%20%20A%20--%3E%7C%E6%9C%AA%E6%89%A7%E8%A1%8C%7C%20E%5B%E8%8A%82%E7%82%B9%20E%5D%0A%20%20%20%20D%20--%3E%7C%E6%89%A7%E8%A1%8C%E5%90%8E%E7%BB%AD%E8%8A%82%E7%82%B9%E9%93%BE%7C%20F%5BD.next...%5D%0A%20%20%20%20F%20--%3E%7C%E8%8A%82%E7%82%B9%E9%93%BE%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%B7%B3%E5%9B%9E%7C%20A%0A"})]),fallback:s(()=>[...i[3]||(i[3]=[a(" Loading... ",-1)])]),_:1})),i[8]||(i[8]=n(`<h4 id="anchor-anchor" tabindex="-1"><code>anchor</code> / <code>[Anchor]</code> <a class="header-anchor" href="#anchor-anchor" aria-label="Permalink to &quot;\`anchor\` / \`[Anchor]\`&quot;">​</a></h4><p><strong>类型</strong>: <em>boolean</em><br><strong>默认值</strong>: <code>false</code><br><strong>说明</strong>: 启用锚点引用。当该属性为 true 时，<code>name</code> 字段将被视为锚点名称而非节点名称，运行时会解析为最后设置该锚点的节点。</p><p><strong>使用方式</strong>：</p><ol><li>首先在节点中通过 <code>anchor</code> 字段设置锚点名称</li><li>然后在 <code>next</code> 或 <code>on_error</code> 中通过 <code>[Anchor]</code> 或 <code>anchor</code> 引用该锚点</li></ol><p><strong>示例</strong>：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;anchor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;X&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;anchor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;X&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;D&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;[Anchor]X&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>等价的对象形式：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;next&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;D&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;X&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;anchor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>应用场景</strong>：<br> 适用于需要动态引用节点的场景，例如多个节点可能处理同一类事件，后续需要回到&quot;最后处理该事件的节点&quot;继续执行。</p><h3 id="未来扩展" tabindex="-1">未来扩展 <a class="header-anchor" href="#未来扩展" aria-label="Permalink to &quot;未来扩展&quot;">​</a></h3><p>更多节点属性功能正在规划中，将在后续版本中逐步推出。</p><h2 id="算法类型" tabindex="-1">算法类型 <a class="header-anchor" href="#算法类型" aria-label="Permalink to &quot;算法类型&quot;">​</a></h2><h3 id="directhit" tabindex="-1"><code>DirectHit</code> <a class="header-anchor" href="#directhit" aria-label="Permalink to &quot;\`DirectHit\`&quot;">​</a></h3><p>直接命中，即不进行识别，直接执行动作。</p><h3 id="templatematch" tabindex="-1"><code>TemplateMatch</code> <a class="header-anchor" href="#templatematch" aria-label="Permalink to &quot;\`TemplateMatch\`&quot;">​</a></h3><p>模板匹配，即“找图”。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 识别区域坐标。可选，默认 [0, 0, 0, 0] ，即全屏。</p><ul><li><em>array&lt;int, 4&gt;</em>: 识别区域坐标，[x, y, w, h]，若希望全屏可设为 [0, 0, 0, 0] 。</li><li><em>string</em>: 填写节点名，在之前执行过的某节点识别到的目标范围内识别。</li></ul></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>roi</code> 的基础上额外移动再作为范围，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>template</code>: <em>string</em> | <em>list&lt;string, &gt;</em><br> 模板图片路径，需要 <code>image</code> 文件夹的相对路径。必选。<br> 所使用的图片需要是无损原图缩放到 720p 后的裁剪。请参考 <a href="1.1-QuickStarted#%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6">这里</a>。<br> 支持填写文件夹路径，将递归加载其中所有图片文件。</p></li><li><p><code>threshold</code>: <em>double</em> | <em>list&lt;double, &gt;</em><br> 模板匹配阈值。可选，默认 0.7 。<br> 若为数组，长度需和 <code>template</code> 数组长度相同。</p></li><li><p><code>order_by</code>: <em>string</em><br> 结果排序方式。可选，默认 <code>Horizontal</code>。<br> 可选的值：<code>Horizontal</code> | <code>Vertical</code> | <code>Score</code> | <code>Random</code> 。<br> 可结合 <code>index</code> 字段使用。</p></li><li><p><code>index</code>: <em>int</em><br> 命中第几个结果。可选，默认 0 。<br> 假设共有 N 个结果，则 <code>index</code> 的取值范围为 [-N, N - 1] ，其中负数使用类 Python 的规则转换为 N - index 。若超出范围，则视为当前识别无结果。</p></li><li><p><code>method</code>: <em>int</em><br> 模板匹配算法，即 cv::TemplateMatchModes。可选，默认 5 。<br> 仅支持 1、3、5，可简单理解为越大的越精确，但也会更慢。<br> 详情请参考 <a href="https://docs.opencv.org/4.x/df/dfb/group__imgproc__object.html" target="_blank" rel="noopener noreferrer">OpenCV 官方文档</a>。</p></li><li><p><code>green_mask</code>: <em>bool</em><br> 是否进行绿色掩码。可选，默认 false 。<br> 若为 true，可以将图片中不希望匹配的部分涂绿 RGB: (0, 255, 0)，则不对绿色部分进行匹配。</p></li></ul><h3 id="featurematch" tabindex="-1"><code>FeatureMatch</code> <a class="header-anchor" href="#featurematch" aria-label="Permalink to &quot;\`FeatureMatch\`&quot;">​</a></h3><p>特征匹配，泛化能力更强的“找图”，具有抗透视、抗尺寸变化等特点。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 同 <code>TemplateMatch</code>.<code>roi</code> 。</p></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 同 <code>TemplateMatch</code>.<code>roi_offset</code> 。</p></li><li><p><code>template</code>: <em>string</em> | <em>list&lt;string, &gt;</em><br> 模板图片路径，需要 <code>image</code> 文件夹的相对路径。必选。<br> 支持填写文件夹路径，将递归加载其中所有图片文件。</p></li><li><p><code>count</code>: <em>uint</em><br> 匹配的特征点的最低数量要求（阈值）。可选，默认 4 。</p></li><li><p><code>order_by</code>: <em>string</em><br> 结果排序方式。可选，默认 <code>Horizontal</code> 。<br> 可选的值：<code>Horizontal</code> | <code>Vertical</code> | <code>Score</code> | <code>Area</code> | <code>Random</code> 。<br> 可结合 <code>index</code> 字段使用。</p></li><li><p><code>index</code>: <em>int</em><br> 命中第几个结果。可选，默认 0 。<br> 假设共有 N 个结果，则 <code>index</code> 的取值范围为 [-N, N - 1] ，其中负数使用类 Python 的规则转换为 N - index 。若超出范围，则视为当前识别无结果。</p></li><li><p><code>green_mask</code>: <em>bool</em><br> 是否进行绿色掩码。可选，默认 false 。<br> 若为 true，可以将图片中不希望匹配的部分涂绿 RGB: (0, 255, 0)，则不对绿色部分进行匹配。</p></li><li><p><code>detector</code>: <em>string</em><br> 特征检测器。可选，默认 <code>SIFT</code> 。<br> 目前支持以下算法：</p><ul><li>SIFT<br> 计算复杂度高，具有尺度不变性、旋转不变性。效果最好。</li><li>KAZE<br> 适用于2D和3D图像，具有尺度不变性、旋转不变性。</li><li>AKAZE<br> 计算速度较快，具有尺度不变性、旋转不变性。</li><li>BRISK<br> 计算速度非常快，具有尺度不变性、旋转不变性。</li><li>ORB<br> 计算速度非常快，具有旋转不变性。但不具有尺度不变性。</li></ul><p>各算法特点详情可自行进一步查询。</p></li><li><p><code>ratio</code>: <em>double</em><br> KNN 匹配算法的距离比值，[0 - 1.0] , 越大则匹配越宽松（更容易连线）。可选，默认 0.6 。</p></li></ul><h3 id="colormatch" tabindex="-1"><code>ColorMatch</code> <a class="header-anchor" href="#colormatch" aria-label="Permalink to &quot;\`ColorMatch\`&quot;">​</a></h3><p>颜色匹配，即“找色”。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 同 <code>TemplateMatch</code>.<code>roi</code> 。</p></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 同 <code>TemplateMatch</code>.<code>roi_offset</code> 。</p></li><li><p><code>method</code>: <em>int</em><br> 颜色匹配方式。即 cv::ColorConversionCodes。可选，默认 4 (RGB) 。<br> 常用值：4 (RGB, 3 通道), 40 (HSV, 3 通道), 6 (GRAY, 1 通道)。<br> 详情请参考 <a href="https://docs.opencv.org/4.x/d8/d01/group__imgproc__color__conversions.html" target="_blank" rel="noopener noreferrer">OpenCV 官方文档</a>。</p></li><li><p><code>lower</code>: <em>list&lt;int, &gt;</em> | <em>list&lt;list&lt;int, &gt;&gt;</em><br> 颜色下限值。必选。最内层 list 长度需和 <code>method</code> 的通道数一致。</p></li><li><p><code>upper</code>: <em>list&lt;int, &gt;</em> | <em>list&lt;list&lt;int, &gt;&gt;</em><br> 颜色上限值。必选。最内层 list 长度需和 <code>method</code> 的通道数一致。</p></li><li><p><code>count</code>: <em>uint</em><br> 符合的像素点的最低数量要求（阈值）。可选，默认 1。</p></li><li><p><code>order_by</code>: <em>string</em><br> 结果排序方式。可选，默认 <code>Horizontal</code> 。<br> 可选的值：<code>Horizontal</code> | <code>Vertical</code> | <code>Score</code> | <code>Area</code> | <code>Random</code> 。<br> 可结合 <code>index</code> 字段使用。</p></li><li><p><code>index</code>: <em>int</em><br> 命中第几个结果。可选，默认 0 。<br> 假设共有 N 个结果，则 <code>index</code> 的取值范围为 [-N, N - 1] ，其中负数使用类 Python 的规则转换为 N - index 。若超出范围，则视为当前识别无结果。</p></li><li><p><code>connected</code>: <em>bool</em><br> 是否是相连的点才会被计数。可选，默认 false 。<br> 若为是，在完成颜色过滤后，则只会计数像素点 <strong>全部相连</strong> 的最大块。<br> 若为否，则不考虑这些像素点是否相连。</p></li></ul><h3 id="ocr" tabindex="-1"><code>OCR</code> <a class="header-anchor" href="#ocr" aria-label="Permalink to &quot;\`OCR\`&quot;">​</a></h3><p>文字识别。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 同 <code>TemplateMatch</code>.<code>roi</code> 。</p></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 同 <code>TemplateMatch</code>.<code>roi_offset</code> 。</p></li><li><p><code>expected</code>: <em>string</em> | <em>list&lt;string, &gt;</em><br> 期望的结果，支持正则。必选。</p></li><li><p><code>threshold</code>: <em>double</em><br> 模型置信度阈值。可选，默认 0.3 。</p></li><li><p><code>replace</code>: <em>array&lt;string, 2&gt;</em> | <em>list&lt;array&lt;string, 2&gt;&gt;</em><br> 部分文字识别结果不准确，进行替换。可选。</p></li><li><p><code>order_by</code>: <em>string</em><br> 结果排序方式。可选，默认 <code>Horizontal</code>。<br> 可选的值：<code>Horizontal</code> | <code>Vertical</code> | <code>Area</code> | <code>Length</code> | <code>Random</code> | <code>Expected</code> 。<br> 可结合 <code>index</code> 字段使用。</p></li><li><p><code>index</code>: <em>int</em><br> 命中第几个结果。可选，默认 0 。<br> 假设共有 N 个结果，则 <code>index</code> 的取值范围为 [-N, N - 1] ，其中负数使用类 Python 的规则转换为 N - index 。若超出范围，则视为当前识别无结果。</p></li><li><p><code>only_rec</code>: <em>bool</em><br> 是否仅识别（不进行检测，需要精确设置 <code>roi</code>）。可选，默认 false 。</p></li><li><p><code>model</code>: <em>string</em><br> 模型 <strong>文件夹</strong> 路径。使用 <code>model/ocr</code> 文件夹的相对路径。可选，默认为空。<br> 若为空，则为 <code>model/ocr</code> 根目录下的模型文件。<br> 文件夹中需要包含 <code>rec.onnx</code>, <code>det.onnx</code>, <code>keys.txt</code> 三个文件。</p></li></ul><h3 id="neuralnetworkclassify" tabindex="-1"><code>NeuralNetworkClassify</code> <a class="header-anchor" href="#neuralnetworkclassify" aria-label="Permalink to &quot;\`NeuralNetworkClassify\`&quot;">​</a></h3><p>深度学习分类，判断图像中的 <strong>固定位置</strong> 是否为预期的“类别”。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 同 <code>TemplateMatch</code>.<code>roi</code> 。</p></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 同 <code>TemplateMatch</code>.<code>roi_offset</code> 。</p></li><li><p><code>labels</code>: <em>list&lt;string, &gt;</em><br> 标注，即每个分类的名字。可选。<br> 仅影响调试图片及日志等，若未填写则会填充 &quot;Unknown&quot; 。</p></li><li><p><code>model</code>: <em>string</em><br> 模型文件路径。使用 <code>model/classify</code> 文件夹的相对路径。必选。<br> 目前仅支持 ONNX 模型，参考 <a href="https://github.com/MaaXYZ/MaaNeuralNetworkCookbook/tree/main/NeuralNetworkClassify" target="_blank" rel="noopener noreferrer">NNClassify 食谱</a>。</p></li><li><p><code>expected</code>: <em>int</em> | <em>list&lt;int, &gt;</em><br> 期望的分类下标。必选。</p></li><li><p><code>order_by</code>: <em>string</em><br> 结果排序方式。可选，默认 <code>Horizontal</code> 。<br> 可选的值：<code>Horizontal</code> | <code>Vertical</code> | <code>Score</code> | <code>Random</code> | <code>Expected</code> 。<br> 可结合 <code>index</code> 字段使用。</p></li><li><p><code>index</code>: <em>int</em><br> 命中第几个结果。可选，默认 0 。<br> 假设共有 N 个结果，则 <code>index</code> 的取值范围为 [-N, N - 1] ，其中负数使用类 Python 的规则转换为 N - index 。若超出范围，则视为当前识别无结果。</p></li></ul><p>举例：例如画面中 <strong>固定位置</strong> 可能出现 猫、狗、老鼠，我们训练了支持该三分类的模型。<br> 希望识别到 猫 或 老鼠 才点击，而识别到 狗 不点击，则相关字段为：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;labels&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Dog&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mouse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;expected&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>注意这些值需要与模型实际输出相符。</p><h3 id="neuralnetworkdetect" tabindex="-1"><code>NeuralNetworkDetect</code> <a class="header-anchor" href="#neuralnetworkdetect" aria-label="Permalink to &quot;\`NeuralNetworkDetect\`&quot;">​</a></h3><p>深度学习目标检测，高级版“找图”。</p><p>与分类器主要区别在于“找”，即支持任意位置。但通常来说模型复杂度会更高，需要更多的训练集、训练时间，使用时的资源占用（推理开销）也会成倍上涨。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 同 <code>TemplateMatch</code>.<code>roi</code> 。</p></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 同 <code>TemplateMatch</code>.<code>roi_offset</code> 。</p></li><li><p><code>labels</code>: <em>list&lt;string, &gt;</em><br> 标注，即每个分类的名字。可选。<br> 仅影响调试图片及日志等。若未填写，会自动从模型 metadata 中读取（支持从 <code>names</code>、<code>name</code>、<code>labels</code>、<code>class_names</code> 字段读取），一般无需手动设置。若模型 metadata 中也没有，则会填充 &quot;Unknown&quot; 。</p></li><li><p><code>model</code>: <em>string</em><br> 模型文件路径。使用 <code>model/detect</code> 文件夹的相对路径。必选。<br> 目前支持由 YOLOv8 和 YOLOv11 导出的 ONNX 格式的模型，其他同样输入输出的 YOLO 模型理论上也可以支持，但未经测试。<br> 训练参考 <a href="https://github.com/MaaXYZ/MaaNeuralNetworkCookbook/tree/main/NeuralNetworkDetect" target="_blank" rel="noopener noreferrer">NNDetect 食谱</a>。</p></li><li><p><code>expected</code>: <em>int</em> | <em>list&lt;int, &gt;</em><br> 期望的分类下标。</p></li><li><p><code>threshold</code>: <em>double</em> | <em>list&lt;double, &gt;</em><br> 模型置信度阈值。可选，默认 0.3 。<br> 若为数组，长度需和 <code>expected</code> 数组长度相同。</p></li><li><p><code>order_by</code>: <em>string</em><br> 结果排序方式。可选，默认 <code>Horizontal</code> 。<br> 可选的值：<code>Horizontal</code> | <code>Vertical</code> | <code>Score</code> | <code>Area</code> | <code>Random</code> | <code>Expected</code> 。<br> 可结合 <code>index</code> 字段使用。</p></li><li><p><code>index</code>: <em>int</em><br> 命中第几个结果。可选，默认 0 。<br> 假设共有 N 个结果，则 <code>index</code> 的取值范围为 [-N, N - 1] ，其中负数使用类 Python 的规则转换为 N - index 。若超出范围，则视为当前识别无结果。</p></li></ul><p>举例：例如画面中可能出现 猫、狗、老鼠，我们训练了支持该三分类的检测模型。<br> 希望检测到 猫 或 老鼠 才点击，而识别到 狗 不点击，则相关字段为：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;labels&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Dog&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mouse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;expected&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>注意这些值需要与模型实际输出相符。</p><h3 id="custom" tabindex="-1"><code>Custom</code> <a class="header-anchor" href="#custom" aria-label="Permalink to &quot;\`Custom\`&quot;">​</a></h3><p>执行通过 <code>MaaResourceRegisterCustomRecognition</code> 接口传入的识别器句柄。</p><p>该算法属性需额外部分字段：</p><ul><li><p><code>custom_recognition</code>: <em>string</em><br> 识别名，同注册接口传入的识别名。同时会通过 <code>MaaCustomRecognitionCallback</code>.<code>custom_recognition_name</code> 传出。必选。</p></li><li><p><code>custom_recognition_param</code>: <em>any</em><br> 识别参数，任意类型，会通过 <code>MaaCustomRecognitionCallback</code>.<code>custom_recognition_param</code> 传出。可选，默认 <code>null</code> 。</p></li><li><p><code>roi</code>: <em>array&lt;int, 4&gt;</em> | <em>string</em><br> 同 <code>TemplateMatch</code>.<code>roi</code>，会通过 <code>MaaCustomRecognitionCallback</code>.<code>roi</code> 传出。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>roi_offset</code>: <em>array&lt;int, 4&gt;</em><br> 同 <code>TemplateMatch</code>.<code>roi_offset</code> 。</p></li></ul><h2 id="动作类型" tabindex="-1">动作类型 <a class="header-anchor" href="#动作类型" aria-label="Permalink to &quot;动作类型&quot;">​</a></h2><h3 id="donothing" tabindex="-1"><code>DoNothing</code> <a class="header-anchor" href="#donothing" aria-label="Permalink to &quot;\`DoNothing\`&quot;">​</a></h3><p>什么都不做。</p><h3 id="click" tabindex="-1"><code>Click</code> <a class="header-anchor" href="#click" aria-label="Permalink to &quot;\`Click\`&quot;">​</a></h3><p>点击。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>target</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em><br> 点击目标的位置。可选，默认 true 。</p><ul><li><em>true</em>: 目标为本节点中刚刚识别到的位置（即自身）。</li><li><em>string</em>: 填写节点名，目标为之前执行过的某节点识别到的位置。</li><li><em>array&lt;int, 2&gt;</em>: 固定坐标点 <code>[x, y]</code>。</li><li><em>array&lt;int, 4&gt;</em>: 固定坐标区域 <code>[x, y, w, h]</code>，会在矩形内随机选取一点（越靠近中心概率越高，边缘概率相对较低），若希望全屏可设为 [0, 0, 0, 0] 。</li></ul></li><li><p><code>target_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>target</code> 的基础上额外移动再作为点击目标，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>contact</code>: <em>uint</em><br> 触点编号，用于区分不同的触控点。可选，默认 0 。</p><ul><li>Adb 控制器：表示手指编号（0 为第一根手指，1 为第二根手指，以此类推）</li><li>Win32 控制器：表示鼠标按键编号（0 为左键，1 为右键，2 为中键，3 为 XBUTTON1，4 为 XBUTTON2）</li></ul></li></ul><h3 id="longpress" tabindex="-1"><code>LongPress</code> <a class="header-anchor" href="#longpress" aria-label="Permalink to &quot;\`LongPress\`&quot;">​</a></h3><p>长按。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>target</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em><br> 长按目标的位置。可选，默认 true 。值同上述 <code>Click</code>.<code>target</code> 。</p></li><li><p><code>target_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>target</code> 的基础上额外移动再作为长按目标，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>duration</code>: <em>uint</em><br> 长按持续时间，单位毫秒。可选，默认 1000 。</p></li><li><p><code>contact</code>: <em>uint</em><br> 触点编号，用于区分不同的触控点。可选，默认 0 。</p><ul><li>Adb 控制器：表示手指编号（0 为第一根手指，1 为第二根手指，以此类推）</li><li>Win32 控制器：表示鼠标按键编号（0 为左键，1 为右键，2 为中键，3 为 XBUTTON1，4 为 XBUTTON2）</li></ul></li></ul><h3 id="swipe" tabindex="-1"><code>Swipe</code> <a class="header-anchor" href="#swipe" aria-label="Permalink to &quot;\`Swipe\`&quot;">​</a></h3><p>线性滑动。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>begin</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em><br> 滑动起点。可选，默认 true 。值同上述 <code>Click</code>.<code>target</code> 。</p></li><li><p><code>begin_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>begin</code> 的基础上额外移动再作为起点，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>end</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em> | <em>list&lt;true | string | array&lt;int, 2&gt; | array&lt;int, 4&gt;&gt;</em><br> 滑动终点。可选，默认 true 。值同上述 <code>Click</code>.<code>target</code> 。<br> 💡 v4.5.x 版本新增支持 <em>list</em>，可用于添加滑动途径点！相较多次 swipe 的区别是多个 end 之间不会抬手，即一次折线滑动。</p></li><li><p><code>end_offset</code>: <em>array&lt;int, 4&gt;</em> | <em>list&lt;array&lt;int, 4&gt;&gt;</em><br> 在 <code>end</code> 的基础上额外移动再作为终点，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>duration</code>: <em>uint</em> | <em>list&lt;uint,&gt;</em><br> 滑动持续时间，单位毫秒。可选，默认 200 。</p></li><li><p><code>end_hold</code>: <em>uint</em> | <em>list&lt;uint,&gt;</em><br> 滑动到终点后，额外等待一定时间再抬起，单位 ms。可选，默认 0。</p></li><li><p><code>only_hover</code>: <em>bool</em><br> 仅鼠标悬停移动，无按下/抬起动作。可选，默认 false。</p></li><li><p><code>contact</code>: <em>uint</em><br> 触点编号，用于区分不同的触控点。可选，默认 0 。</p><ul><li>Adb 控制器：表示手指编号（0 为第一根手指，1 为第二根手指，以此类推）</li><li>Win32 控制器：表示鼠标按键编号（0 为左键，1 为右键，2 为中键，3 为 XBUTTON1，4 为 XBUTTON2）</li></ul></li></ul><h3 id="multiswipe" tabindex="-1"><code>MultiSwipe</code> <a class="header-anchor" href="#multiswipe" aria-label="Permalink to &quot;\`MultiSwipe\`&quot;">​</a></h3><p>多指线性滑动。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>swipes</code>: <em>list&lt;object,&gt;</em><br> 多个滑动的数组。必选。<br> 数组元素顺序没有影响，只基于 <code>starting</code> 确定顺序。</p><ul><li><p><code>starting</code>: <em>uint</em><br> 滑动起始时间，单位毫秒。可选，默认 0 。<br><code>MultiSwipe</code> 额外字段，该滑动会在本 action 中第 <code>starting</code> 毫秒才开始。</p></li><li><p><code>begin</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em><br> 滑动起点。可选，默认 true 。值同上述 <code>Click</code>.<code>target</code> 。</p></li><li><p><code>begin_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>begin</code> 的基础上额外移动再作为起点，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>end</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em> | <em>list&lt;true | string | array&lt;int, 2&gt; | array&lt;int, 4&gt;&gt;</em><br> 滑动终点。可选，默认 true 。值同上述 <code>Click</code>.<code>target</code> 。<br> 💡 v4.5.x 版本新增支持 <em>list</em>，可用于添加滑动途径点！相较多次 swipe 的区别是多个 end 之间不会抬手，即一次折线滑动。</p></li><li><p><code>end_offset</code>: <em>array&lt;int, 4&gt;</em> | <em>list&lt;array&lt;int, 4&gt;&gt;</em><br> 在 <code>end</code> 的基础上额外移动再作为终点，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>duration</code>: <em>uint</em> | <em>list&lt;uint,&gt;</em><br> 滑动持续时间，单位毫秒。可选，默认 200 。</p></li><li><p><code>end_hold</code>: <em>uint</em> | <em>list&lt;uint,&gt;</em><br> 滑动到终点后，额外等待一定时间再抬起，单位 ms。可选，默认 0。</p></li><li><p><code>only_hover</code>: <em>bool</em><br> 仅鼠标悬停移动，无按下/抬起动作。可选，默认 false。</p></li><li><p><code>contact</code>: <em>uint</em><br> 触点编号，用于区分不同的触控点。可选，默认 0 。</p><ul><li>Adb 控制器：表示手指编号（0 为第一根手指，1 为第二根手指，以此类推）</li><li>Win32 控制器：表示鼠标按键编号（0 为左键，1 为右键，2 为中键，3 为 XBUTTON1，4 为 XBUTTON2）<br><strong>注意</strong>：在 <code>MultiSwipe</code> 中，如果 <code>contact</code> 为 0，将使用该滑动在数组中的索引作为触点编号。</li></ul></li></ul></li></ul><p>举例：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MultiSwipe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;swipes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;begin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;starting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;begin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="touchdown" tabindex="-1"><code>TouchDown</code> <a class="header-anchor" href="#touchdown" aria-label="Permalink to &quot;\`TouchDown\`&quot;">​</a></h3><p>按下触控点。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>contact</code>: <em>uint</em><br> 触点编号，用于区分不同的触控点。可选，默认 0 。</p><ul><li>Adb 控制器：表示手指编号（0 为第一根手指，1 为第二根手指，以此类推）</li><li>Win32 控制器：表示鼠标按键编号（0 为左键，1 为右键，2 为中键，3 为 XBUTTON1，4 为 XBUTTON2）</li></ul></li><li><p><code>target</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 4&gt;</em><br> 触控目标的位置。可选，默认 true ，取值含义同 <code>Click</code>.<code>target</code> 。</p></li><li><p><code>target_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>target</code> 的基础上额外移动再作为触控目标，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>pressure</code>: <em>int</em><br> 触控压力，范围取决于控制器实现。可选，默认 0 。</p></li></ul><h3 id="touchmove" tabindex="-1"><code>TouchMove</code> <a class="header-anchor" href="#touchmove" aria-label="Permalink to &quot;\`TouchMove\`&quot;">​</a></h3><p>移动触控点。字段含义与 <code>TouchDown</code> 一致，用于更新触点位置。</p><h3 id="touchup" tabindex="-1"><code>TouchUp</code> <a class="header-anchor" href="#touchup" aria-label="Permalink to &quot;\`TouchUp\`&quot;">​</a></h3><p>抬起触控点。</p><ul><li><code>contact</code>: <em>uint</em><br> 触点编号，用于区分不同的触控点。可选，默认 0 。 <ul><li>Adb 控制器：表示手指编号（0 为第一根手指，1 为第二根手指，以此类推）</li><li>Win32 控制器：表示鼠标按键编号（0 为左键，1 为右键，2 为中键，3 为 XBUTTON1，4 为 XBUTTON2）</li></ul></li></ul><h3 id="scroll" tabindex="-1"><code>Scroll</code> <a class="header-anchor" href="#scroll" aria-label="Permalink to &quot;\`Scroll\`&quot;">​</a></h3><p>鼠标滚轮滚动。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>dx</code>: <em>int</em><br> 水平滚动距离，正值向右滚动，负值向左滚动。可选，默认 0 。</p></li><li><p><code>dy</code>: <em>int</em><br> 垂直滚动距离，正值向下滚动，负值向上滚动。可选，默认 0 。</p></li></ul><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>Adb 控制器不支持滚动操作。仅 Win32 控制器支持。</p></div><h3 id="clickkey" tabindex="-1"><code>ClickKey</code> <a class="header-anchor" href="#clickkey" aria-label="Permalink to &quot;\`ClickKey\`&quot;">​</a></h3><p>单击按键。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>key</code>: <em>int</em> | <em>list&lt;int, &gt;</em><br> 要单击的键，仅支持对应控制器的虚拟按键码。必选。</p><ul><li><a href="https://developer.android.com/reference/android/view/KeyEvent" target="_blank" rel="noopener noreferrer">Adb 控制器</a></li><li><a href="https://learn.microsoft.com/en-us/windows/win32/inputdev/virtual-key-codes" target="_blank" rel="noopener noreferrer">Win32 控制器</a></li></ul></li></ul><h3 id="longpresskey" tabindex="-1"><code>LongPressKey</code> <a class="header-anchor" href="#longpresskey" aria-label="Permalink to &quot;\`LongPressKey\`&quot;">​</a></h3><p>长按按键。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>key</code>: <em>int</em> | <em>list&lt;int, &gt;</em><br> 要按的键，仅支持对应控制器的虚拟按键码。必选。</p></li><li><p><code>duration</code>: <em>uint</em><br> 长按持续时间，单位毫秒。可选，默认 1000 。</p></li></ul><h3 id="keydown" tabindex="-1"><code>KeyDown</code> <a class="header-anchor" href="#keydown" aria-label="Permalink to &quot;\`KeyDown\`&quot;">​</a></h3><p>按下按键但不立即松开。可与 <code>KeyUp</code> 配合实现自定义按键时序。</p><p>该动作属性需额外部分字段：</p><ul><li><code>key</code>: <em>int</em><br> 要按下的键，仅支持对应控制器的虚拟按键码。必选。</li></ul><h3 id="keyup" tabindex="-1"><code>KeyUp</code> <a class="header-anchor" href="#keyup" aria-label="Permalink to &quot;\`KeyUp\`&quot;">​</a></h3><p>松开按键。用于结束 <code>KeyDown</code> 建立的按键状态。</p><p>该动作属性需额外部分字段：</p><ul><li><code>key</code>: <em>int</em><br> 要松开的键，仅支持对应控制器的虚拟按键码。必选。</li></ul><h3 id="inputtext" tabindex="-1"><code>InputText</code> <a class="header-anchor" href="#inputtext" aria-label="Permalink to &quot;\`InputText\`&quot;">​</a></h3><p>输入文本。</p><p>该动作属性需额外部分字段：</p><ul><li><code>input_text</code>: <em>string</em><br> 要输入的文本，部分控制器仅支持 ascii 。必选。</li></ul><h3 id="startapp" tabindex="-1"><code>StartApp</code> <a class="header-anchor" href="#startapp" aria-label="Permalink to &quot;\`StartApp\`&quot;">​</a></h3><p>启动 App 。</p><p>该动作属性需额外部分字段：</p><ul><li><code>package</code>: <em>string</em><br> 启动入口。必选。<br> 需要填入 package name 或 activity ，例如 <code>com.hypergryph.arknights</code> 或 <code>com.hypergryph.arknights/com.u8.sdk.U8UnityContext</code> 。</li></ul><h3 id="stopapp" tabindex="-1"><code>StopApp</code> <a class="header-anchor" href="#stopapp" aria-label="Permalink to &quot;\`StopApp\`&quot;">​</a></h3><p>关闭 App 。</p><p>该动作属性需额外部分字段：</p><ul><li><code>package</code>: <em>string</em><br> 要关闭的程序。必选。<br> 需要填入 package name ，例如 <code>com.hypergryph.arknights</code> 。</li></ul><h3 id="stoptask" tabindex="-1"><code>StopTask</code> <a class="header-anchor" href="#stoptask" aria-label="Permalink to &quot;\`StopTask\`&quot;">​</a></h3><p>停止当前任务链（MaaTaskerPostTask 传入的单个任务链）。</p><h3 id="command" tabindex="-1"><code>Command</code> <a class="header-anchor" href="#command" aria-label="Permalink to &quot;\`Command\`&quot;">​</a></h3><p>执行命令。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>exec</code>: <em>string</em><br> 执行的程序路径。必选。</p></li><li><p><code>args</code>: <em>list&lt;string,&gt;</em><br> 执行的参数。可选。<br> 支持部分运行期参数替换：</p><ul><li><code>{ENTRY}</code>: 任务入口名。</li><li><code>{NODE}</code>: 当前节点名。</li><li><code>{IMAGE}</code>: 截图保存到文件的路径。该文件在进程退出前删除，若要持久保存请自行复制。</li><li><code>{BOX}</code>: 识别命中的目标，格式为 <code>[x, y, w, h]</code>。</li><li><code>{RESOURCE_DIR}</code>: 最后一次加载的资源文件夹路径。</li><li><code>{LIBRARY_DIR}</code>: MaaFW 库所在的文件夹路径。</li></ul></li><li><p><code>detach</code>: <em>bool</em><br> 分离子进程，即不等待子进程执行完成，直接继续执行后面的任务。可选，默认 false。</p></li></ul><p>举例：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Command&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;exec&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Python&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;args&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;{RESOURCE_DIR}/my_script/test.py&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;Haha&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;{IMAGE}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;{NODE}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;{BOX}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;NodeB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Command&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;exec&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{RESOURCE_DIR}/my_exec/my_exec.exe&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>实际将会执行命令</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># NodeA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C:/MaaXXX/resource/my_script/test.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Haha</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C:/temp/123.png</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NodeA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [0,0,0,0]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># NodeB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:/MaaXXX/resource/my_exec/my_exec.exe</span></span></code></pre></div><h3 id="custom-1" tabindex="-1"><code>Custom</code> <a class="header-anchor" href="#custom-1" aria-label="Permalink to &quot;\`Custom\`&quot;">​</a></h3><p>执行通过 <code>MaaResourceRegisterCustomAction</code> 接口传入的动作句柄。</p><p>该动作属性需额外部分字段：</p><ul><li><p><code>custom_action</code>: <em>string</em><br> 动作名，同注册接口传入的识别器名。同时会通过 <code>MaaCustomActionCallback</code>.<code>custom_action_name</code> 传出。必选。</p></li><li><p><code>custom_action_param</code>: <em>any</em><br> 动作参数，任意类型，会通过 <code>MaaCustomActionCallback</code>.<code>custom_action_param</code> 传出。可选，默认 <code>null</code> 。</p></li><li><p><code>target</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em><br> 目标的位置，会通过 <code>MaaCustomActionCallback</code>.<code>box</code> 传出。可选，默认 true 。值同 <code>Click</code>.<code>target</code>，</p></li><li><p><code>target_offset</code>: <em>array&lt;int, 4&gt;</em><br> 值同 <code>Click</code>.<code>target_offset</code> 。</p></li></ul><h2 id="等待画面静止" tabindex="-1">等待画面静止 <a class="header-anchor" href="#等待画面静止" aria-label="Permalink to &quot;等待画面静止&quot;">​</a></h2><p>等待画面静止。需连续一定时间 画面 <strong>没有较大变化</strong> 才会退出动作。</p><p>字段值为 uint 或 object，举例：</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;pre_wait_freezes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;pre_wait_freezes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // more properties ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>若值为 object，可设置部分额外字段：</p><ul><li><p><code>time</code>: <em>uint</em><br> 连续 <code>time</code> 毫秒 画面 <strong>没有较大变化</strong> 才会退出动作。可选，默认 1 。</p></li><li><p><code>target</code>: <em>true</em> | <em>string</em> | <em>array&lt;int, 2&gt;</em> | <em>array&lt;int, 4&gt;</em><br> 等待目标的位置。可选，默认 true。值同上述 <code>Click</code>.<code>target</code> 。</p></li><li><p><code>target_offset</code>: <em>array&lt;int, 4&gt;</em><br> 在 <code>target</code> 的基础上额外移动再作为等待目标，四个值分别相加。可选，默认 [0, 0, 0, 0] 。</p></li><li><p><code>threshold</code>: <em>double</em><br> 判断“没有较大变化”的模板匹配阈值。可选，默认 0.95 。</p></li><li><p><code>method</code>: <em>int</em><br> 判断“没有较大变化”的模板匹配算法，即 cv::TemplateMatchModes。可选，默认 5 。<br> 同 <code>TemplateMatch</code>.<code>method</code> 。</p></li><li><p><code>rate_limit</code>: <em>uint</em><br> 识别速率限制，单位毫秒。可选，默认 1000 。<br> 每次识别最低消耗 <code>rate_limit</code> 毫秒，不足的时间将会 sleep 等待。</p></li><li><p><code>timeout</code>: <em>uint</em><br> 识别超时时间，毫秒。可选，默认 20 * 1000 。</p></li></ul><h2 id="节点通知" tabindex="-1">节点通知 <a class="header-anchor" href="#节点通知" aria-label="Permalink to &quot;节点通知&quot;">​</a></h2><p>通过配置 <code>focus</code> 字段，可以让 UI 在节点执行的特定阶段向用户展示自定义消息。</p><h3 id="配置方式" tabindex="-1">配置方式 <a class="header-anchor" href="#配置方式" aria-label="Permalink to &quot;配置方式&quot;">​</a></h3><p>在节点中添加 <code>focus</code> 字段，键为消息类型，值为要展示的模板字符串。模板中可使用 <code>{字段名}</code> 格式的占位符，UI 会自动替换为实际值。</p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;focus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;Node.Recognition.Succeeded&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{name} 识别命中，准备开始执行&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;Node.Action.Starting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{name} 开始执行，任务 ID: {task_id}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="可用的消息类型" tabindex="-1">可用的消息类型 <a class="header-anchor" href="#可用的消息类型" aria-label="Permalink to &quot;可用的消息类型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>消息类型</th><th>触发时机</th><th>可用占位符</th></tr></thead><tbody><tr><td><code>Node.Recognition.Starting</code></td><td>识别开始</td><td><code>task_id</code>, <code>reco_id</code>, <code>name</code></td></tr><tr><td><code>Node.Recognition.Succeeded</code></td><td>识别成功</td><td><code>task_id</code>, <code>reco_id</code>, <code>name</code></td></tr><tr><td><code>Node.Recognition.Failed</code></td><td>识别失败</td><td><code>task_id</code>, <code>reco_id</code>, <code>name</code></td></tr><tr><td><code>Node.Action.Starting</code></td><td>动作开始</td><td><code>task_id</code>, <code>action_id</code>, <code>name</code></td></tr><tr><td><code>Node.Action.Succeeded</code></td><td>动作成功</td><td><code>task_id</code>, <code>action_id</code>, <code>name</code></td></tr><tr><td><code>Node.Action.Failed</code></td><td>动作失败</td><td><code>task_id</code>, <code>action_id</code>, <code>name</code></td></tr></tbody></table><h3 id="更多消息类型" tabindex="-1">更多消息类型 <a class="header-anchor" href="#更多消息类型" aria-label="Permalink to &quot;更多消息类型&quot;">​</a></h3><p>完整的回调消息列表和详细说明请参考 <a href="2.3-CallbackProtocol">回调协议</a> 和 <a href="https://github.com/MaaXYZ/MaaFramework/blob/main/include/MaaFramework/MaaMsg.h" target="_blank" rel="noopener noreferrer">MaaMsg.h</a>。</p>`,141))])}const B=h(k,[["render",E]]);export{F as __pageData,B as default};
