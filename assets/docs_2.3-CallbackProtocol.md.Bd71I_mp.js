import{_ as i,c as a,o as n,a2 as t}from"./chunks/framework.DYZYzxF5.js";const c=JSON.parse('{"title":"回调协议","description":"","frontmatter":{},"headers":[],"relativePath":"docs/2.3-CallbackProtocol.md","filePath":"docs/2.3-回调协议.md","lastUpdated":null}'),e={name:"docs/2.3-CallbackProtocol.md"};function l(h,s,k,p,d,o){return n(),a("div",null,s[0]||(s[0]=[t(`<h1 id="回调协议" tabindex="-1">回调协议 <a class="header-anchor" href="#回调协议" aria-label="Permalink to &quot;回调协议&quot;">​</a></h1><p>MaaFramework 通过 <code>MaaEventCallback</code> 回调函数向上层应用发送各种状态通知和事件消息。所有回调消息都采用统一的格式：消息类型（message）+ 详细数据（details）。</p><h2 id="消息格式" tabindex="-1">消息格式 <a class="header-anchor" href="#消息格式" aria-label="Permalink to &quot;消息格式&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MAA_CALL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MaaEventCallback)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> handle, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> details_json, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trans_arg);</span></span></code></pre></div><ul><li><strong>handle</strong>: 相关对象的句柄 <ul><li>MaaTasker* for MaaTasker event</li><li>MaaResource* for MaaResource event</li><li>MaaController* for MaaController event</li><li>MaaContext* for MaaContext event</li></ul></li><li><strong>message</strong>: 消息类型字符串，标识事件类型</li><li><strong>details_json</strong>: JSON 格式的详细数据，包含具体的事件信息</li><li><strong>callback_arg</strong>: 用户自定义的回调参数</li></ul><h2 id="消息类型" tabindex="-1">消息类型 <a class="header-anchor" href="#消息类型" aria-label="Permalink to &quot;消息类型&quot;">​</a></h2><h3 id="资源加载消息" tabindex="-1">资源加载消息 <a class="header-anchor" href="#资源加载消息" aria-label="Permalink to &quot;资源加载消息&quot;">​</a></h3><p>用于通知资源加载的状态变化。</p><h4 id="resource-loading-starting" tabindex="-1"><code>Resource.Loading.Starting</code> <a class="header-anchor" href="#resource-loading-starting" aria-label="Permalink to &quot;\`Resource.Loading.Starting\`&quot;">​</a></h4><p>资源开始加载时发送。</p><p><strong>details_json 结构：</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;res_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;abc123def456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/path/to/resource&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>res_id</code>: 资源 ID（数字）</li><li><code>hash</code>: 资源哈希值（字符串）</li><li><code>path</code>: 资源路径（字符串）</li></ul><h4 id="resource-loading-succeeded" tabindex="-1"><code>Resource.Loading.Succeeded</code> <a class="header-anchor" href="#resource-loading-succeeded" aria-label="Permalink to &quot;\`Resource.Loading.Succeeded\`&quot;">​</a></h4><p>资源加载成功时发送。数据结构同上。</p><h4 id="resource-loading-failed" tabindex="-1"><code>Resource.Loading.Failed</code> <a class="header-anchor" href="#resource-loading-failed" aria-label="Permalink to &quot;\`Resource.Loading.Failed\`&quot;">​</a></h4><p>资源加载失败时发送。数据结构同上。</p><h3 id="控制器动作消息" tabindex="-1">控制器动作消息 <a class="header-anchor" href="#控制器动作消息" aria-label="Permalink to &quot;控制器动作消息&quot;">​</a></h3><p>用于通知控制器执行动作的状态。</p><h4 id="controller-action-starting" tabindex="-1"><code>Controller.Action.Starting</code> <a class="header-anchor" href="#controller-action-starting" aria-label="Permalink to &quot;\`Controller.Action.Starting\`&quot;">​</a></h4><p>控制器开始执行动作时发送。</p><p><strong>details_json 结构：</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;ctrl_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;param&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>ctrl_id</code>: 控制器 ID（数字）</li><li><code>uuid</code>: 唯一标识符（字符串）</li><li><code>action</code>: 动作类型（字符串）</li><li><code>param</code>: 动作参数（对象）</li></ul><h4 id="controller-action-succeeded" tabindex="-1"><code>Controller.Action.Succeeded</code> <a class="header-anchor" href="#controller-action-succeeded" aria-label="Permalink to &quot;\`Controller.Action.Succeeded\`&quot;">​</a></h4><p>控制器动作执行成功时发送。数据结构同上。</p><h4 id="controller-action-failed" tabindex="-1"><code>Controller.Action.Failed</code> <a class="header-anchor" href="#controller-action-failed" aria-label="Permalink to &quot;\`Controller.Action.Failed\`&quot;">​</a></h4><p>控制器动作执行失败时发送。数据结构同上。</p><h3 id="任务消息" tabindex="-1">任务消息 <a class="header-anchor" href="#任务消息" aria-label="Permalink to &quot;任务消息&quot;">​</a></h3><p>用于通知任务执行的状态。</p><h4 id="tasker-task-starting" tabindex="-1"><code>Tasker.Task.Starting</code> <a class="header-anchor" href="#tasker-task-starting" aria-label="Permalink to &quot;\`Tasker.Task.Starting\`&quot;">​</a></h4><p>任务开始执行时发送。</p><p><strong>details_json 结构：</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;task_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;entry&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyTask&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;abc123def456&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>task_id</code>: 任务 ID（数字）</li><li><code>entry</code>: 入口任务名称（字符串）</li><li><code>uuid</code>: 唯一标识符（字符串）</li><li><code>hash</code>: 任务哈希值（字符串）</li></ul><h4 id="tasker-task-succeeded" tabindex="-1"><code>Tasker.Task.Succeeded</code> <a class="header-anchor" href="#tasker-task-succeeded" aria-label="Permalink to &quot;\`Tasker.Task.Succeeded\`&quot;">​</a></h4><p>任务执行成功时发送。数据结构同上。</p><h4 id="tasker-task-failed" tabindex="-1"><code>Tasker.Task.Failed</code> <a class="header-anchor" href="#tasker-task-failed" aria-label="Permalink to &quot;\`Tasker.Task.Failed\`&quot;">​</a></h4><p>任务执行失败时发送。数据结构同上。</p><h3 id="节点下一步列表消息" tabindex="-1">节点下一步列表消息 <a class="header-anchor" href="#节点下一步列表消息" aria-label="Permalink to &quot;节点下一步列表消息&quot;">​</a></h3><p>用于通知节点的下一步动作列表。</p><h4 id="node-nextlist-starting" tabindex="-1"><code>Node.NextList.Starting</code> <a class="header-anchor" href="#node-nextlist-starting" aria-label="Permalink to &quot;\`Node.NextList.Starting\`&quot;">​</a></h4><p>节点开始确定下一步动作列表时发送。</p><p><strong>details_json 结构：</strong></p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;task_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;list&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;focus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>task_id</code>: 任务 ID（数字）</li><li><code>name</code>: 节点名称（字符串）</li><li><code>list</code>: 下一步动作列表（字符串数组）</li><li><code>focus</code>: 焦点相关数据（任意类型）</li></ul><h4 id="node-nextlist-succeeded" tabindex="-1"><code>Node.NextList.Succeeded</code> <a class="header-anchor" href="#node-nextlist-succeeded" aria-label="Permalink to &quot;\`Node.NextList.Succeeded\`&quot;">​</a></h4><p>节点成功确定下一步动作列表时发送。数据结构同上。</p><h4 id="node-nextlist-failed" tabindex="-1"><code>Node.NextList.Failed</code> <a class="header-anchor" href="#node-nextlist-failed" aria-label="Permalink to &quot;\`Node.NextList.Failed\`&quot;">​</a></h4><p>节点确定下一步动作列表失败时发送。数据结构同上。</p><h3 id="节点识别消息" tabindex="-1">节点识别消息 <a class="header-anchor" href="#节点识别消息" aria-label="Permalink to &quot;节点识别消息&quot;">​</a></h3><p>用于通知节点识别过程的状态。</p><h4 id="node-recognition-starting" tabindex="-1"><code>Node.Recognition.Starting</code> <a class="header-anchor" href="#node-recognition-starting" aria-label="Permalink to &quot;\`Node.Recognition.Starting\`&quot;">​</a></h4><p>节点开始识别时发送。</p><p><strong>details_json 结构：</strong></p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;task_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;reco_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">67890</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;focus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>task_id</code>: 任务 ID（数字）</li><li><code>reco_id</code>: 识别 ID（数字）</li><li><code>name</code>: 节点名称（字符串）</li><li><code>focus</code>: 焦点相关数据（任意类型）</li></ul><h4 id="node-recognition-succeeded" tabindex="-1"><code>Node.Recognition.Succeeded</code> <a class="header-anchor" href="#node-recognition-succeeded" aria-label="Permalink to &quot;\`Node.Recognition.Succeeded\`&quot;">​</a></h4><p>节点识别成功时发送。数据结构同上。</p><h4 id="node-recognition-failed" tabindex="-1"><code>Node.Recognition.Failed</code> <a class="header-anchor" href="#node-recognition-failed" aria-label="Permalink to &quot;\`Node.Recognition.Failed\`&quot;">​</a></h4><p>节点识别失败时发送。数据结构同上。</p><h3 id="节点动作消息" tabindex="-1">节点动作消息 <a class="header-anchor" href="#节点动作消息" aria-label="Permalink to &quot;节点动作消息&quot;">​</a></h3><p>用于通知节点执行动作的状态。</p><h4 id="node-action-starting" tabindex="-1"><code>Node.Action.Starting</code> <a class="header-anchor" href="#node-action-starting" aria-label="Permalink to &quot;\`Node.Action.Starting\`&quot;">​</a></h4><p>节点开始执行动作时发送。</p><p><strong>details_json 结构：</strong></p><div class="language-jsonc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;task_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12345</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;node_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">67890</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;action_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11111</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NodeA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;focus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>task_id</code>: 任务 ID（数字）</li><li><code>action_id</code>: 操作 ID（数字）</li><li><code>name</code>: 节点名称（字符串）</li><li><code>focus</code>: 焦点相关数据（任意类型）</li></ul><h4 id="node-action-succeeded" tabindex="-1"><code>Node.Action.Succeeded</code> <a class="header-anchor" href="#node-action-succeeded" aria-label="Permalink to &quot;\`Node.Action.Succeeded\`&quot;">​</a></h4><p>节点动作执行成功时发送。数据结构同上。</p><h4 id="node-action-failed" tabindex="-1"><code>Node.Action.Failed</code> <a class="header-anchor" href="#node-action-failed" aria-label="Permalink to &quot;\`Node.Action.Failed\`&quot;">​</a></h4><p>节点动作执行失败时发送。数据结构同上。</p><h2 id="使用示例" tabindex="-1">使用示例 <a class="header-anchor" href="#使用示例" aria-label="Permalink to &quot;使用示例&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> details_json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> callback_arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 解析消息类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">strcmp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(message, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Tasker.Task.Starting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 解析 JSON 获取任务详情</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 更新 UI 显示任务开始状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">strcmp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(message, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Node.Recognition.Succeeded&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 处理识别成功事件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 更新识别结果显示</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... 处理其他消息类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置回调</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MaaTaskerAddSink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tasker, MyCallback, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nullptr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MaaTaskerAddNodeSink</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tasker, MyCallback, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nullptr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><ol><li><strong>JSON 解析</strong>: <code>details_json</code> 参数始终为有效的 JSON 字符串，建议使用成熟的 JSON 库进行解析</li><li><strong>线程安全</strong>: 回调函数可能在不同线程中被调用，需要注意线程安全</li><li><strong>性能考虑</strong>: 回调函数应尽快返回，避免阻塞框架的执行流程</li><li><strong>错误处理</strong>: 建议在回调函数中添加异常处理，防止回调函数异常影响框架运行</li></ol>`,76)]))}const E=i(e,[["render",l]]);export{c as __pageData,E as default};
